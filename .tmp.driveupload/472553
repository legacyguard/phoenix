var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;import{j as r}from"./vendor-ui-DOX-GngI.js";import{c,U as d,j as o,y as h,z as x,E as m,F as u,G as j,h as p,a5 as y,C as v,a as f,b as g,p as N,e as b,Q as w,R as k,V as C,Y as M,d as A,i as F,B as _,ar as O,u as T,S,A as B,a4 as D,n as R}from"./index-Co25CVR3.js";import{r as E}from"./vendor-react-BsuoGMue.js";import{u as $}from"./vendor-i18n-C5HfoztV.js";import{T as I}from"./target-vW6VfDZU.js";import{C as K}from"./clock-C7EaDSNX.js";import{T as q}from"./trending-up-D8-VI5LC.js";import{R as z,A as P,b as U,X as Q,Y as L,T as V,L as W,c as G,B as J,d as Z,C as Y,P as H,a as X}from"./vendor-charts-CvH0jBkX.js";import{a as ee}from"./vendor-utils-DZ4dNBww.js";import{A as se}from"./activity-DgRx_-qU.js";import"./vendor-auth-CQQWOfx5.js";import"./vendor-supabase-DjxWZ-e5.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=c("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),te=c("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),ie=c("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),le={fetchAnalytics:()=>{return e=void 0,s=null,a=function*(){const e=yield fetch("/api/admin/analytics",{headers:{Authorization:`Bearer ${localStorage.getItem("clerk-db-jwt")}`}});if(!e.ok)throw new Error("Failed to fetch analytics");return e.json()},new Promise((t,i)=>{var l=e=>{try{r(a.next(e))}catch(s){i(s)}},n=e=>{try{r(a.throw(e))}catch(s){i(s)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,n);r((a=a.apply(e,s)).next())});var e,s,a}},ne={curious:"#3B82F6",anxious:"#EF4444",relieved:"#10B981",accomplished:"#8B5CF6",confused:"#F59E0B",motivated:"#EC4899",satisfied:"#06B6D4",frustrated:"#DC2626",neutral:"#6B7280"},re=()=>{const{t:e}=$("common"),[c,T]=E.useState([]),[S,B]=E.useState(!0),[D,R]=E.useState("7d"),[te,re]=E.useState(0),[ce,de]=E.useState({dau:0,onboardingRate:0,taskCompletionRate:0,avgTimeToFirstAction:0,retentionRate:0,featureAdoption:0});E.useEffect(()=>{if(!S)return;const e=le.subscribe(e=>{const r=(c=((e,s)=>{for(var a in s||(s={}))i.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&n(e,a,s[a]);return e})({},e),d={id:`${Date.now()}-${Math.random()}`,timestamp:new Date},s(c,a(d)));var c,d;T(e=>[r,...e].slice(0,50))});return()=>e.unsubscribe()},[S]),E.useEffect(()=>{const e=()=>{de({dau:Math.floor(500*Math.random())+100,onboardingRate:30*Math.random()+70,taskCompletionRate:40*Math.random()+50,avgTimeToFirstAction:Math.floor(300*Math.random())+60,retentionRate:30*Math.random()+60,featureAdoption:50*Math.random()+30})};e();const s=setInterval(e,3e4);return()=>clearInterval(s)},[D,te]);const oe=e=>{switch(e){case"curious":return ae;case"anxious":case"frustrated":return F;case"relieved":case"satisfied":return o;case"accomplished":return I;case"motivated":return ie;default:return se}},he=[{stage:"Started",users:1e3,rate:100},{stage:"Q1 Completed",users:850,rate:85},{stage:"Q2 Completed",users:720,rate:72},{stage:"Q3 Completed",users:650,rate:65},{stage:"Q4 Completed",users:600,rate:60},{stage:"Tasks Generated",users:580,rate:58}],xe=[{name:"Curious",value:35,color:ne.curious},{name:"Anxious",value:15,color:ne.anxious},{name:"Relieved",value:20,color:ne.relieved},{name:"Accomplished",value:25,color:ne.accomplished},{name:"Frustrated",value:5,color:ne.frustrated}],me=Array.from({length:7},(e,s)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][s],active:Math.floor(200*Math.random())+50,new:Math.floor(50*Math.random())+10})),ue=[{label:e("analytics.metrics.dailyActiveUsers"),value:ce.dau,change:12,icon:d,color:"text-blue-600"},{label:e("analytics.metrics.onboardingCompletion"),value:`${ce.onboardingRate.toFixed(1)}%`,change:-3,icon:o,color:"text-green-600"},{label:e("analytics.metrics.taskCompletion"),value:`${ce.taskCompletionRate.toFixed(1)}%`,change:5,icon:I,color:"text-purple-600"},{label:e("analytics.metrics.timeToFirstAction"),value:`${Math.floor(ce.avgTimeToFirstAction/60)}m ${ce.avgTimeToFirstAction%60}s`,change:-15,icon:K,color:"text-orange-600"}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:e("analytics.title")}),r.jsx("p",{className:"text-muted-foreground",children:e("analytics.subtitle")})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs(h,{value:D,onValueChange:e=>R(e),children:[r.jsx(x,{className:"w-[140px]",children:r.jsx(m,{})}),r.jsxs(u,{children:[r.jsx(j,{value:"24h",children:e("analytics.timeRange.24h")}),r.jsx(j,{value:"7d",children:e("analytics.timeRange.7d")}),r.jsx(j,{value:"30d",children:e("analytics.timeRange.30d")})]})]}),r.jsx(p,{variant:"outline",size:"icon",onClick:()=>{re(e=>e+1)},children:r.jsx(y,{className:"h-4 w-4"})})]})]}),r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:ue.map((s,a)=>r.jsxs(v,{children:[r.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(g,{className:"text-sm font-medium",children:s.label}),r.jsx(s.icon,{className:N("h-4 w-4",s.color)})]}),r.jsxs(b,{children:[r.jsx("div",{className:"text-2xl font-bold",children:s.value}),void 0!==s.change&&r.jsxs("p",{className:N("text-xs flex items-center mt-1",s.change>0?"text-green-600":"text-red-600"),children:[r.jsx(q,{className:N("h-3 w-3 mr-1",s.change<0&&"rotate-180")}),Math.abs(s.change),e("analytics.analyticsDashboard.from_last_period_1")]})]})]},a))}),r.jsxs(w,{defaultValue:"insights",className:"space-y-4",children:[r.jsxs(k,{children:[r.jsx(C,{value:"insights",children:e("analytics.tabs.insights")}),r.jsx(C,{value:"funnel",children:e("analytics.tabs.funnel")}),r.jsx(C,{value:"emotions",children:e("analytics.tabs.emotions")}),r.jsx(C,{value:"events",children:e("analytics.tabs.events")})]}),r.jsxs(M,{value:"insights",className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs(v,{children:[r.jsxs(f,{children:[r.jsx(g,{children:e("analytics.charts.userActivity.title")}),r.jsx(A,{children:e("analytics.charts.userActivity.description")})]}),r.jsx(b,{children:r.jsx(z,{width:e("assets.assetOverview.100_2"),height:300,children:r.jsxs(P,{data:me,children:[r.jsx(U,{strokeDasharray:e("analytics.analyticsDashboard.3_3_7")}),r.jsx(Q,{dataKey:"day"}),r.jsx(L,{}),r.jsx(V,{}),r.jsx(W,{}),r.jsx(G,{type:"monotone",dataKey:"active",stackId:"1",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6,name:e("analytics.charts.userActivity.active")}),r.jsx(G,{type:"monotone",dataKey:"new",stackId:"1",stroke:"#10B981",fill:"#10B981",fillOpacity:.6,name:e("analytics.charts.userActivity.new")})]})})})]}),r.jsxs(v,{children:[r.jsxs(f,{children:[r.jsx(g,{children:e("analytics.charts.featureUsage.title")}),r.jsx(A,{children:e("analytics.charts.featureUsage.description")})]}),r.jsx(b,{children:r.jsx(z,{width:e("assets.assetOverview.100_2"),height:300,children:r.jsxs(J,{data:[{feature:"Document Upload",usage:85,adoption:72},{feature:"Guardian Invite",usage:62,adoption:45},{feature:"Will Builder",usage:45,adoption:38},{feature:"Asset Tracking",usage:78,adoption:65},{feature:"Emergency Contacts",usage:92,adoption:88}],layout:"horizontal",children:[r.jsx(U,{strokeDasharray:e("analytics.analyticsDashboard.3_3_7")}),r.jsx(Q,{dataKey:"feature"}),r.jsx(L,{}),r.jsx(V,{}),r.jsx(W,{}),r.jsx(Z,{dataKey:"usage",fill:"#8B5CF6",name:e("analytics.charts.featureUsage.usage")}),r.jsx(Z,{dataKey:"adoption",fill:"#EC4899",name:e("analytics.charts.featureUsage.adoption")})]})})})]})]}),r.jsxs(v,{children:[r.jsx(f,{children:r.jsxs(g,{className:"flex items-center space-x-2",children:[r.jsx(ae,{className:"h-5 w-5"}),r.jsx("span",{children:e("analytics.insights.title")})]})}),r.jsx(b,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(F,{className:"h-5 w-5 text-amber-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e("analytics.insights.lowCompletion.title")}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e("analytics.insights.lowCompletion.description")}),r.jsx(p,{variant:"link",className:"h-auto p-0 mt-1",children:e("analytics.insights.lowCompletion.action")})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(q,{className:"h-5 w-5 text-green-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e("analytics.insights.highEngagement.title")}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e("analytics.insights.highEngagement.description")})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(I,{className:"h-5 w-5 text-purple-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:e("analytics.insights.opportunity.title")}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e("analytics.insights.opportunity.description")}),r.jsx(p,{variant:"link",className:"h-auto p-0 mt-1",children:e("analytics.insights.opportunity.action")})]})]})]})})]})]}),r.jsx(M,{value:"funnel",className:"space-y-4",children:r.jsxs(v,{children:[r.jsxs(f,{children:[r.jsx(g,{children:e("analytics.charts.onboardingFunnel.title")}),r.jsx(A,{children:e("analytics.charts.onboardingFunnel.description")})]}),r.jsxs(b,{children:[r.jsx(z,{width:e("assets.assetOverview.100_2"),height:400,children:r.jsxs(J,{data:he,layout:"horizontal",children:[r.jsx(U,{strokeDasharray:e("analytics.analyticsDashboard.3_3_7")}),r.jsx(Q,{dataKey:"stage"}),r.jsx(L,{}),r.jsx(V,{}),r.jsx(Z,{dataKey:"users",fill:"#3B82F6",children:he.map((e,s)=>r.jsx(Y,{fill:`rgba(59, 130, 246, ${1-.15*s})`},`cell-${s}`))})]})}),r.jsx("div",{className:"mt-6 space-y-3",children:he.slice(0,-1).map((s,a)=>{const t=he[a+1],i=((s.users-t.users)/s.users*100).toFixed(1);return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"font-medium",children:[s.stage," → ",t.stage]}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.users," → ",t.users," users"]})]}),r.jsxs(_,{variant:parseFloat(i)>20?"destructive":"secondary",children:[i,e("analytics.analyticsDashboard.drop_off_8")]})]},a)})})]})]})}),r.jsx(M,{value:"emotions",className:"space-y-4",children:r.jsxs(v,{children:[r.jsxs(f,{children:[r.jsx(g,{children:e("analytics.charts.emotionalJourney.title")}),r.jsx(A,{children:e("analytics.charts.emotionalJourney.description")})]}),r.jsx(b,{children:r.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[r.jsx(z,{width:e("assets.assetOverview.100_2"),height:300,children:r.jsxs(H,{children:[r.jsx(X,{data:xe,cx:e("assets.assetOverview.50_4"),cy:e("assets.assetOverview.50_4"),labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:xe.map((e,s)=>r.jsx(Y,{fill:e.color},`cell-${s}`))}),r.jsx(V,{})]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"font-medium",children:e("analytics.emotions.insights")}),xe.map((e,s)=>{const a=oe(e.name.toLowerCase());return r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(a,{className:"h-4 w-4",style:{color:e.color}}),r.jsx("span",{className:"text-sm",children:e.name})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-24 h-2 bg-muted rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full",style:{width:`${e.value}%`,backgroundColor:e.color}})}),r.jsxs("span",{className:"text-sm text-muted-foreground w-10 text-right",children:[e.value,"%"]})]})]},s)})]})]})})]})}),r.jsx(M,{value:"events",className:"space-y-4",children:r.jsxs(v,{children:[r.jsx(f,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(g,{children:e("analytics.eventStream.title")}),r.jsx(A,{children:e("analytics.eventStream.description")})]}),r.jsx(p,{variant:S?"secondary":"default",size:"sm",onClick:()=>B(!S),children:e(S?"analytics.eventStream.pause":"analytics.eventStream.resume")})]})}),r.jsx(b,{children:r.jsx(O,{className:"h-[500px] pr-4",children:r.jsx("div",{className:"space-y-2",children:0===c.length?r.jsx("p",{className:"text-center text-muted-foreground py-8",children:e("analytics.eventStream.empty")}):c.map(e=>{const s=oe(e.emotional_context),a=(t=e.emotional_context,ne[t]||ne.neutral);var t;return r.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[r.jsx(s,{className:"h-4 w-4 mt-0.5",style:{color:a}}),r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-medium",children:e.event_name}),r.jsx("span",{className:"text-xs text-muted-foreground",children:ee(e.timestamp,{addSuffix:!0})})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(_,{variant:"outline",className:"text-xs",children:e.user_journey_stage}),e.emotional_context&&r.jsx(_,{variant:"outline",className:"text-xs",style:{borderColor:a,color:a},children:e.emotional_context})]}),e.properties&&Object.keys(e.properties).length>0&&r.jsx("p",{className:"text-xs text-muted-foreground",children:JSON.stringify(e.properties,null,2)})]})]},e.id)})})})})]})})]})]})},ce=()=>{const{t:e}=$("common"),{isTrackingEnabled:s}=T({componentName:"Analytics"});return s?r.jsxs("div",{className:"container mx-auto px-4 lg:px-8 py-8 space-y-8",children:[!1,r.jsx(re,{})]}):r.jsx("div",{className:"container mx-auto px-4 lg:px-8 py-8",children:r.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"h-16 w-16 bg-muted rounded-full flex items-center justify-center",children:r.jsx(S,{className:"h-8 w-8 text-muted-foreground"})})}),r.jsx("h1",{className:"text-3xl font-bold",children:e("analytics.disabled.title")}),r.jsx("p",{className:"text-xl text-muted-foreground",children:e("analytics.disabled.subtitle")})]}),r.jsxs(B,{children:[r.jsx(F,{className:"h-4 w-4"}),r.jsx(D,{children:e("analytics.disabled.alert.title")}),r.jsx(R,{children:e("analytics.disabled.alert.description")})]}),r.jsxs(v,{children:[r.jsxs(f,{children:[r.jsx(g,{children:e("analytics.disabled.privacy.title")}),r.jsx(A,{children:e("analytics.disabled.privacy.description")})]}),r.jsxs(b,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium",children:e("analytics.disabled.privacy.whatWeTrack")}),r.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[r.jsx("li",{children:e("analytics.disabled.privacy.item1")}),r.jsx("li",{children:e("analytics.disabled.privacy.item2")}),r.jsx("li",{children:e("analytics.disabled.privacy.item3")}),r.jsx("li",{children:e("analytics.disabled.privacy.item4")})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium",children:e("analytics.disabled.privacy.whatWeDontTrack")}),r.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[r.jsx("li",{children:e("analytics.disabled.privacy.noItem1")}),r.jsx("li",{children:e("analytics.disabled.privacy.noItem2")}),r.jsx("li",{children:e("analytics.disabled.privacy.noItem3")})]})]}),r.jsxs("div",{className:"pt-4 flex items-center justify-between",children:[r.jsx(p,{variant:"outline",asChild:!0,children:r.jsx("a",{href:"/user-profile",children:e("analytics.disabled.privacy.manageConsent")})}),r.jsx(p,{variant:"link",asChild:!0,children:r.jsxs("a",{href:"/privacy-policy",children:[e("analytics.disabled.privacy.learnMore"),r.jsx(te,{className:"ml-2 h-3 w-3"})]})})]})]})]})]})})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{ce as default};

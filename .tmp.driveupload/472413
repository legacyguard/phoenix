import{j as e}from"./vendor-ui-DOX-GngI.js";import{r as s}from"./vendor-react-BsuoGMue.js";import{c as a,U as n,Z as r,B as i,C as l,a as d,b as c,e as o,Q as m,R as x,V as h,Y as u,d as j}from"./index-Co25CVR3.js";import{P as p}from"./progress-cOZa_oNl.js";import{u as v}from"./vendor-i18n-C5HfoztV.js";import{A as y}from"./activity-DgRx_-qU.js";import{T as g}from"./target-vW6VfDZU.js";import{T as f}from"./trending-up-D8-VI5LC.js";import{R as b,A as _,b as N,X as w,Y as D,T as U,L as S,c as A,B as k,d as C,e as P}from"./vendor-charts-CvH0jBkX.js";import"./vendor-auth-CQQWOfx5.js";import"./vendor-supabase-DjxWZ-e5.js";import"./vendor-utils-DZ4dNBww.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=a("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),O={overview:{totalUsers:12847,activeUsers:8432,avgSessionDuration:"14:32",bounceRate:23.5},userJourney:{onboardingCompletionRate:82,firstPossessionAdded:65,firstTrustedPersonAdded:61,firstDocumentUploaded:58,willGenerated:43},featureAdoption:{localOnlyModeUsers:15,familyHubUsers:45,documentScannerUsers:72,emergencyAccessSetup:38,pushNotificationsEnabled:64},preparednessStats:{averageOverallScore:68,willsCreated:55,documentsUploaded:8.3,trustedPeopleAdded:3.2},abTestResults:[{testName:t("analytics.testData.dashboardTitleExperiment"),controlConversion:12.5,variationConversion:14.8,winner:t("analytics.testData.variation"),confidence:97,sampleSize:5430,duration:14},{testName:t("analytics.testData.onboardingFlowSimplification"),controlConversion:41.2,variationConversion:52.7,winner:t("analytics.testData.variation"),confidence:99.2,sampleSize:3210,duration:21}],userSegments:[{segment:t("analytics.testData.highlyEngaged"),percentage:22,description:"Login weekly, >80% preparedness"},{segment:t("analytics.testData.moderatelyEngaged"),percentage:45,description:"Login monthly, 40-80% preparedness"},{segment:t("analytics.testData.atRisk"),percentage:25,description:"Haven't logged in >30 days"},{segment:t("analytics.testData.dormant"),percentage:8,description:"No activity >90 days"}],timeSeriesData:[{date:"2024-01",activeUsers:5234,newUsers:892},{date:"2024-02",activeUsers:6122,newUsers:1203},{date:"2024-03",activeUsers:7234,newUsers:1567},{date:"2024-04",activeUsers:8122,newUsers:1832},{date:"2024-05",activeUsers:8932,newUsers:1623},{date:"2024-06",activeUsers:8432,newUsers:1402}]},R=()=>{const{t:a}=v(),[t,R]=s.useState("30d"),[E,K]=s.useState(!0),[z,J]=s.useState(O),[L,F]=s.useState(null);s.useEffect(()=>{const e=()=>{return e=void 0,s=null,a=function*(){K(!0),F(null);try{const e=yield fetch("/api/admin/analytics");if(!e.ok){if(403===e.status)throw new Error("Unauthorized access");throw new Error("Failed to fetch analytics")}const s=yield e.json();J(s)}catch(e){F(e instanceof Error?e.message:"Failed to load analytics"),J(O)}finally{K(!1)}},new Promise((t,n)=>{var r=e=>{try{l(a.next(e))}catch(s){n(s)}},i=e=>{try{l(a.throw(e))}catch(s){n(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,i);l((a=a.apply(e,s)).next())});var e,s,a};e();const s=setInterval(e,3e5);return()=>clearInterval(s)},[]);const $=[{stage:"Sign Up",value:100},{stage:"Complete Onboarding",value:z.userJourney.onboardingCompletionRate,dropoff:18},{stage:"Add First Possession",value:z.userJourney.firstPossessionAdded,dropoff:17},{stage:"Add Trusted Person",value:z.userJourney.firstTrustedPersonAdded,dropoff:4},{stage:"Upload Document",value:z.userJourney.firstDocumentUploaded,dropoff:3},{stage:"Generate Will",value:z.userJourney.willGenerated,dropoff:15}],I=[{title:"Total Users",value:z.overview.totalUsers.toLocaleString(),change:12.5,trend:"up",icon:e.jsx(n,{className:"h-5 w-5"})},{title:"Active Users",value:z.overview.activeUsers.toLocaleString(),change:8.3,trend:"up",icon:e.jsx(y,{className:"h-5 w-5"})},{title:"Avg. Preparedness",value:`${z.preparednessStats.averageOverallScore}%`,change:3.2,trend:"up",icon:e.jsx(g,{className:"h-5 w-5"})},{title:"Wills Created",value:`${z.preparednessStats.willsCreated}%`,change:-2.1,trend:"down",icon:e.jsx(r,{className:"h-5 w-5"})}];return E&&!z?e.jsx("div",{className:"p-4 md:p-6 font-sans bg-gray-50 min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:a("admin.analyticsDashboard.loading_analytics_data_1")})]})}):e.jsx("div",{className:"p-4 md:p-6 font-sans bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a("admin.analyticsDashboard.analytics_dashboard_2")}),e.jsx("p",{className:"text-gray-600",children:a("admin.analyticsDashboard.monitor_user_engagement_featur_3")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[E&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600 mr-2"}),a("admin.analyticsDashboard.refreshing_4")]}),L&&e.jsx(i,{variant:"outline",className:"text-red-600",children:a("admin.analyticsDashboard.using_cached_data_5")})]})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:I.map((s,t)=>e.jsxs(l,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:s.title}),s.icon]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.value}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center mt-1",children:["up"===s.trend?e.jsx(f,{className:"h-3 w-3 text-green-600 mr-1"}):e.jsx(T,{className:"h-3 w-3 text-red-600 mr-1"}),e.jsxs("span",{className:"up"===s.trend?"text-green-600":"text-red-600",children:[Math.abs(s.change),"%"]}),e.jsx("span",{className:"text-gray-500 ml-1",children:a("admin.analyticsDashboard.from_last_month_6")})]})]})]},t))}),e.jsxs(m,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(x,{children:[e.jsx(h,{value:"overview",children:"Overview"}),e.jsx(h,{value:"funnel",children:a("admin.analyticsDashboard.user_journey_7")}),e.jsx(h,{value:"features",children:a("admin.analyticsDashboard.feature_adoption_8")}),e.jsx(h,{value:"experiments",children:a("admin.analyticsDashboard.a_b_tests_9")}),e.jsx(h,{value:"segments",children:a("admin.analyticsDashboard.user_segments_30")})]}),e.jsx(u,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:a("admin.analyticsDashboard.user_growth_11")}),e.jsx(j,{children:a("admin.analyticsDashboard.active_and_new_users_over_time_12")})]}),e.jsx(o,{children:e.jsx(b,{width:a("assets.assetOverview.100_2"),height:300,children:e.jsxs(_,{data:z.timeSeriesData,children:[e.jsx(N,{strokeDasharray:a("analytics.analyticsDashboard.3_3_7")}),e.jsx(w,{dataKey:"date"}),e.jsx(D,{}),e.jsx(U,{}),e.jsx(S,{}),e.jsx(A,{type:"monotone",dataKey:"activeUsers",stackId:"1",stroke:"#8884d8",fill:"#8884d8"}),e.jsx(A,{type:"monotone",dataKey:"newUsers",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d"})]})})})]}),e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:a("admin.analyticsDashboard.platform_statistics_15")}),e.jsx(j,{children:a("admin.analyticsDashboard.key_platform_metrics_16")})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.analyticsDashboard.avg_session_duration_17")}),e.jsx("span",{className:"text-2xl font-bold",children:z.overview.avgSessionDuration})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.analyticsDashboard.bounce_rate_18")}),e.jsxs("span",{className:"text-2xl font-bold",children:[z.overview.bounceRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.analyticsDashboard.avg_documents_per_user_19")}),e.jsx("span",{className:"text-2xl font-bold",children:z.preparednessStats.documentsUploaded})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.analyticsDashboard.avg_trusted_people_per_user_20")}),e.jsx("span",{className:"text-2xl font-bold",children:z.preparednessStats.trustedPeopleAdded})]})]})]})]})}),e.jsx(u,{value:"funnel",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:a("admin.analyticsDashboard.user_journey_funnel_21")}),e.jsx(j,{children:a("admin.analyticsDashboard.track_user_progression_through_22")})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:$.map((s,a)=>e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.stage}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[s.value,"%"]}),s.dropoff&&e.jsxs(i,{variant:"outline",className:"text-red-600",children:["-",s.dropoff,"%"]})]})]}),e.jsx(p,{value:s.value,className:"h-2"})]},s.stage))})})]})}),e.jsx(u,{value:"features",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:a("admin.analyticsDashboard.feature_adoption_rates_23")}),e.jsx(j,{children:a("admin.analyticsDashboard.percentage_of_users_using_each_24")})]}),e.jsx(o,{children:e.jsx(b,{width:a("assets.assetOverview.100_2"),height:400,children:e.jsxs(k,{data:Object.entries(z.featureAdoption).map(([e,s])=>({name:e.replace(/([A-Z])/g," $1").trim(),value:s})),layout:"horizontal",children:[e.jsx(N,{strokeDasharray:a("analytics.analyticsDashboard.3_3_7")}),e.jsx(w,{type:"number",domain:[0,100]}),e.jsx(D,{dataKey:"name",type:"category",width:150}),e.jsx(U,{formatter:e=>`${e}%`}),e.jsx(C,{dataKey:"value",fill:"#8b5cf6",children:e.jsx(P,{dataKey:"value",position:"right",formatter:e=>`${e}%`})})]})})})]})}),e.jsx(u,{value:"experiments",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:z.abTestResults.map((s,t)=>e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:s.testName}),e.jsxs(i,{className:"bg-green-100 text-green-800",children:[s.winner," Won"]})]}),e.jsxs(j,{children:[a("admin.analyticsDashboard.sample_size_27"),s.sampleSize.toLocaleString(),a("admin.analyticsDashboard.users_duration_28"),s.duration," days"]})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-gray-50",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Control"}),e.jsxs("p",{className:"text-2xl font-bold",children:[s.controlConversion,"%"]})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-green-50",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Variation"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[s.variationConversion,"%"]})]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-center",children:e.jsxs(i,{variant:"outline",children:[s.confidence,a("admin.analyticsDashboard.confidence_29")]})})]})]},t))})}),e.jsx(u,{value:"segments",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:a("admin.analyticsDashboard.user_segments_30")}),e.jsx(j,{children:a("admin.analyticsDashboard.user_distribution_by_engagemen_31")})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:z.userSegments.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.segment}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[s.percentage,"%"]}),e.jsx(p,{value:s.percentage,className:"w-24 h-2 mt-1"})]})]},a))})})]})})]})]})})};export{R as default};

import{j as s}from"./vendor-ui-DOX-GngI.js";import{u as e,r as a,R as r}from"./vendor-react-BsuoGMue.js";import{s as t}from"./supabaseWithRetry-Cm5ZSG7b.js";import{c as i,t as l,h as c,C as n,a as o,b as d,e as m,B as h,Z as x,d as u,U as v,A as j,n as g,T as p,a9 as f,af as N,H as y}from"./index-Co25CVR3.js";import{S as w}from"./skeleton-CEBCh0Mn.js";import{P as b}from"./progress-cOZa_oNl.js";import{u as _}from"./vendor-i18n-C5HfoztV.js";import{P as k}from"./plus-DkHU5iGY.js";import{T as C}from"./trending-up-D8-VI5LC.js";import{R as S,P as F,a as z,C as $,T as A,L as B}from"./vendor-charts-CvH0jBkX.js";import{B as P}from"./briefcase-CFzSZfRR.js";import{D as R}from"./dollar-sign-DZs5lViZ.js";import{C as D}from"./car-CvFR1N16.js";import"./vendor-auth-CQQWOfx5.js";import"./vendor-supabase-DjxWZ-e5.js";import"./vendor-utils-DZ4dNBww.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=i("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),O={property:y,vehicle:D,financial:R,business:P,personal:N,uncategorized:x},U={property:"#8B5CF6",vehicle:"#3B82F6",financial:"#10B981",business:"#F59E0B",personal:"#EF4444",uncategorized:"#6B7280"},T=()=>{var i,N;const{t:y}=_("common"),P=e(),[R,D]=a.useState(!0),[T,I]=a.useState([]),[K,L]=a.useState([]),[M,V]=a.useState(0),[W,Z]=a.useState("USD"),q=a.useCallback(()=>{return s=void 0,e=null,a=function*(){try{const{data:{user:s}}=yield t.auth.getUser();if(!s)return;const{data:e,error:a}=yield t.rpc("get_asset_statistics",{p_user_id:s.id});if(a)throw a;const r=e||[];I(r);const i=r.reduce((s,e)=>s+(e.total_value||0),0);V(i);const{data:l,error:c}=yield t.rpc("get_unassigned_assets",{p_user_id:s.id});if(c)throw c;L(l||[]);const{data:n}=yield t.from("profiles").select("preferred_currency").eq("id",s.id).single();(null==n?void 0:n.preferred_currency)&&Z(n.preferred_currency)}catch(s){l.error(y("assets.overview.errors.loadFailed"))}finally{D(!1)}},new Promise((r,t)=>{var i=s=>{try{c(a.next(s))}catch(e){t(e)}},l=s=>{try{c(a.throw(s))}catch(e){t(e)}},c=s=>s.done?r(s.value):Promise.resolve(s.value).then(i,l);c((a=a.apply(s,e)).next())});var s,e,a},[y]);a.useEffect(()=>{q()},[q]);const H=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:W,minimumFractionDigits:0,maximumFractionDigits:0}).format(s),Q=s=>O[s]||x,G=s=>U[s]||"#6B7280",J=T.filter(s=>s.count>0).map(s=>({name:y(`assets.categories.${s.category}`),value:s.total_value||0,count:s.count})),X=s=>{P(`/assets/new${s?`?category=${s}`:""}`)};return R?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(e=>s.jsx(w,{className:"h-32"},e))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(w,{className:"h-64"}),s.jsx(w,{className:"h-64"})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:y("assets.overview.title")}),s.jsx("p",{className:"text-muted-foreground",children:y("assets.overview.subtitle")})]}),s.jsxs(c,{onClick:()=>X(),children:[s.jsx(k,{className:"h-4 w-4 mr-2"}),y("assets.overview.addAsset")]})]}),M>0&&s.jsxs(n,{children:[s.jsx(o,{className:"pb-3",children:s.jsxs(d,{className:"flex items-center gap-2",children:[s.jsx(C,{className:"h-5 w-5"}),y("assets.overview.totalPortfolioValue")]})}),s.jsxs(m,{children:[s.jsx("div",{className:"text-3xl font-bold",children:H(M)}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:y("assets.overview.estimatedValue")})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[["property","vehicle","financial","business","personal"].map(e=>{const a=T.find(s=>s.category===e)||{count:0,total_value:0},r=Q(e),t=G(e);return s.jsxs(n,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>P(`/dashboard?category=${e}`),children:[s.jsx(o,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${t}20`},children:s.jsx(r,{className:"h-5 w-5",style:{color:t}})}),s.jsx(d,{className:"text-base",children:y(`assets.categories.${e}`)})]}),s.jsx(h,{variant:"secondary",children:a.count})]})}),s.jsx(m,{children:s.jsxs("div",{className:"space-y-2",children:[a.total_value>0&&s.jsx("p",{className:"text-lg font-semibold",children:H(a.total_value)}),s.jsxs(c,{variant:"ghost",size:"sm",className:"w-full",onClick:s=>{s.stopPropagation(),X(e)},children:[s.jsx(k,{className:"h-3 w-3 mr-1"}),y("assets.overview.addNew")]})]})})]},e)}),(null==(i=T.find(s=>"uncategorized"===s.category))?void 0:i.count)>0&&s.jsx(n,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>P("/dashboard?category=uncategorized"),children:s.jsx(o,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-100",children:s.jsx(x,{className:"h-5 w-5 text-gray-600"})}),s.jsx(d,{className:"text-base",children:y("assets.categories.uncategorized")})]}),s.jsx(h,{variant:"secondary",children:(null==(N=T.find(s=>"uncategorized"===s.category))?void 0:N.count)||0})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[J.length>0&&M>0&&s.jsxs(n,{children:[s.jsxs(o,{children:[s.jsxs(d,{className:"flex items-center gap-2",children:[s.jsx(E,{className:"h-5 w-5"}),y("assets.overview.distribution.title")]}),s.jsx(u,{children:y("assets.overview.distribution.subtitle")})]}),s.jsx(m,{children:s.jsx("div",{className:"h-64",children:s.jsx(S,{width:y("assets.assetOverview.100_2"),height:y("assets.assetOverview.100_2"),children:s.jsxs(F,{children:[s.jsx(z,{data:J,cx:y("assets.assetOverview.50_4"),cy:y("assets.assetOverview.50_4"),labelLine:!1,label:({percent:s})=>`${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:J.map((e,a)=>{var r;const t=null==(r=T[a])?void 0:r.category;return s.jsx($,{fill:G(t)},`cell-${a}`)})}),s.jsx(A,{formatter:s=>H(s),contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"6px"}}),s.jsx(B,{})]})})})})]}),s.jsxs(n,{children:[s.jsxs(o,{children:[s.jsxs(d,{className:"flex items-center gap-2",children:[s.jsx(v,{className:"h-5 w-5"}),y("assets.overview.beneficiaryAllocation.title")]}),s.jsx(u,{children:y("assets.overview.beneficiaryAllocation.subtitle")})]}),s.jsx(m,{children:0===K.length?s.jsx(j,{children:s.jsx(g,{className:"flex items-center gap-2",children:s.jsxs(h,{variant:"outline",className:"bg-green-50",children:["âœ“ ",y("assets.overview.beneficiaryAllocation.allAssigned")]})})}):s.jsxs("div",{className:"space-y-3",children:[s.jsxs(j,{variant:"destructive",children:[s.jsx(p,{className:"h-4 w-4"}),s.jsx(g,{children:y("assets.overview.beneficiaryAllocation.unassignedWarning",{count:K.length})})]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:K.map(e=>s.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>P(`/assets/${e.id}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[r.createElement(Q(e.category),{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium",children:e.name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(b,{value:e.total_allocation,className:"w-20 h-2"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.total_allocation,"%"]})]})]},e.id))}),s.jsxs(c,{variant:"outline",className:"w-full",onClick:()=>P("/dashboard/inheritance-summary"),children:[s.jsx(f,{className:"h-4 w-4 mr-2"}),y("assets.overview.viewInheritanceSummary")]})]})})]})]})]})};export{T as AssetOverview};
